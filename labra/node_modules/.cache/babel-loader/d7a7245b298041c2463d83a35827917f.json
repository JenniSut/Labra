{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jents\\\\OneDrive\\\\Asiakirjat\\\\Kouluhommat\\\\Front end\\\\uusiHarjoitutyo\\\\labra\\\\src\\\\components\\\\TilausEdit.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport TextField from '@material-ui/core/TextField';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Typography from '@material-ui/core/Typography';\nimport DoneAllIcon from '@material-ui/icons/DoneAll';\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\nimport DateFnsUtils from '@date-io/date-fns';\nimport fiLocale from 'date-fns/locale/fi';\nimport axios from 'axios';\nimport { Button } from '@material-ui/core';\nimport { useParams } from 'react-router';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction TilausEdit() {\n  _s();\n\n  //haetaan parametrit urlista ja asetetaan ne tilamuuttujaan\n  let {\n    id,\n    tuote,\n    tilauspaiva,\n    tyontekija,\n    hinta,\n    asiakas\n  } = useParams();\n  const [tilaus, setValues] = useState({\n    id: id,\n    tuote: tuote,\n    tilauspvm: tilauspaiva,\n    tyontekija: tyontekija,\n    toimpvm: null,\n    hinta: hinta,\n    asiakas: asiakas\n  });\n  const [viesti, setViesti] = useState('');\n  const url = 'http://localhost:8080';\n  const [tyontekijat, setTyontekijat] = useState([]); //tilauspäivän muutos\n\n  const muutaPaiva = date => {\n    const tilpaiva = date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate();\n    setValues({ ...tilaus,\n      tilauspvm: tilpaiva\n    });\n  }; //toimituspaivan muutos\n\n\n  const muutaTPaiva = date => {\n    const toimpaiva = date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate();\n    setValues({ ...tilaus,\n      toimpvm: toimpaiva\n    });\n  }; //haetaan työntekijät kannasta formia varten\n\n\n  const haeTyontekijat = async () => {\n    try {\n      const response = await fetch(url + '/kanta/tyontekijat/all');\n      const json = await response.json();\n      setTyontekijat(json);\n    } catch (error) {\n      setTyontekijat([]);\n      console.log('Haku ei onnistunut');\n    }\n\n    ;\n  };\n\n  useEffect(() => {\n    haeTyontekijat();\n  }, []);\n\n  const muuta = e => {\n    setValues({ ...tilaus,\n      [e.target.name]: e.target.value\n    });\n  }; //muokatun tilauksen lisääminen kantaan\n\n\n  const lisaaTilaus = e => {\n    const formData = {\n      'id': tilaus.id,\n      'tuote': tilaus.tuote,\n      'tilauspvm': tilaus.tilauspvm,\n      'toimpvm': tilaus.toimpvm,\n      'hinta': tilaus.hinta,\n      'tyontekija': tilaus.tyontekija,\n      'asiakas': tilaus.asiakas\n    };\n    axios.post(url + '/kanta/tilaukset/edit/' + tilaus.id, formData).then(response => {\n      console.log(tilaus);\n\n      if (response.status === 200) {\n        setValues({ ...tilaus,\n          id: '',\n          tuote: '',\n          tilauspvm: new Date(),\n          tyontekija: '',\n          toimpvm: null,\n          hinta: '',\n          asiakas: ''\n        });\n        setViesti('Muokkaus onnistui, palaa tilauksiin');\n      } else {\n        setViesti('Muokkaus ei onnistunut');\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Paper, {\n      elevation: 3,\n      style: {\n        width: '50%',\n        margin: 10\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"form\", {\n        style: {\n          padding: 20\n        },\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          required: true,\n          fullWidth: true,\n          name: \"tuote\",\n          label: \"Tuote\",\n          value: tilaus.tuote,\n          onChange: e => muuta(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(MuiPickersUtilsProvider, {\n          utils: DateFnsUtils,\n          locale: fiLocale,\n          children: /*#__PURE__*/_jsxDEV(KeyboardDatePicker, {\n            label: \"Tilausp\\xE4iv\\xE4\",\n            name: \"tilauspvm\",\n            fullWidth: true,\n            cancelLabel: \"Peruuta\",\n            required: true,\n            value: tilaus.tilauspvm,\n            onChange: muutaPaiva,\n            format: \"dd.MM.yyyy\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(InputLabel, {\n          id: \"tyont\",\n          children: \"Ty\\xF6ntekij\\xE4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          label: \"Ty\\xF6ntekij\\xE4\",\n          required: true,\n          fullWidth: true,\n          name: \"tyontekija\",\n          value: tilaus.tyontekija,\n          onChange: e => muuta(e),\n          labelId: \"tyont\",\n          children: tyontekijat.map(tyontekija => {\n            return /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: tyontekija.etunimi + \" \" + tyontekija.sukunimi,\n              children: [tyontekija.etunimi, \" \", tyontekija.sukunimi]\n            }, tyontekija.tyontekija_id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 37\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(MuiPickersUtilsProvider, {\n          utils: DateFnsUtils,\n          locale: fiLocale,\n          children: /*#__PURE__*/_jsxDEV(KeyboardDatePicker, {\n            label: \"Toimitusp\\xE4iv\\xE4\",\n            name: \"toimpva\",\n            fullWidth: true,\n            cancelLabel: \"Peruuta\",\n            value: tilaus.toimpvm,\n            onChange: muutaTPaiva,\n            format: \"dd.MM.yyyy\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          required: true,\n          fullWidth: true,\n          name: \"hinta\",\n          label: \"Hinta\",\n          value: tilaus.hinta,\n          onChange: e => muuta(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          required: true,\n          fullWidth: true,\n          name: \"asiakas\",\n          label: \"Asiakas\",\n          value: tilaus.asiakas,\n          onChange: e => muuta(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        style: {\n          margin: 10\n        },\n        variant: \"contained\",\n        color: \"primary\",\n        startIcon: /*#__PURE__*/_jsxDEV(DoneAllIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 32\n        }, this),\n        onClick: lisaaTilaus,\n        children: \"Tallenna muutokset\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        children: viesti\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 9\n  }, this);\n}\n\n_s(TilausEdit, \"y1jBhVDPpVuZhQer6CzJSJpseto=\", false, function () {\n  return [useParams];\n});\n\n_c = TilausEdit;\n;\nexport default TilausEdit;\n\nvar _c;\n\n$RefreshReg$(_c, \"TilausEdit\");","map":{"version":3,"sources":["C:/Users/jents/OneDrive/Asiakirjat/Kouluhommat/Front end/uusiHarjoitutyo/labra/src/components/TilausEdit.js"],"names":["React","useState","useEffect","Paper","TextField","Select","MenuItem","InputLabel","Typography","DoneAllIcon","MuiPickersUtilsProvider","KeyboardDatePicker","DateFnsUtils","fiLocale","axios","Button","useParams","TilausEdit","id","tuote","tilauspaiva","tyontekija","hinta","asiakas","tilaus","setValues","tilauspvm","toimpvm","viesti","setViesti","url","tyontekijat","setTyontekijat","muutaPaiva","date","tilpaiva","getFullYear","getMonth","getDate","muutaTPaiva","toimpaiva","haeTyontekijat","response","fetch","json","error","console","log","muuta","e","target","name","value","lisaaTilaus","formData","post","then","status","Date","width","margin","padding","map","etunimi","sukunimi","tyontekija_id"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,QAAP,MAAqB,4BAArB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,OAAOC,WAAP,MAAwB,4BAAxB;AAEA,SAAQC,uBAAR,EAAiCC,kBAAjC,QAA2D,sBAA3D;AACA,OAAOC,YAAP,MAAyB,mBAAzB;AACA,OAAOC,QAAP,MAAqB,oBAArB;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,MAAT,QAAuB,mBAAvB;AACA,SAASC,SAAT,QAA0B,cAA1B;;;AAEA,SAASC,UAAT,GAAsB;AAAA;;AAClB;AACA,MAAI;AAACC,IAAAA,EAAD;AAAKC,IAAAA,KAAL;AAAYC,IAAAA,WAAZ;AAAyBC,IAAAA,UAAzB;AAAqCC,IAAAA,KAArC;AAA4CC,IAAAA;AAA5C,MAAuDP,SAAS,EAApE;AAEA,QAAM,CAACQ,MAAD,EAASC,SAAT,IAAsBxB,QAAQ,CAAE;AAClCiB,IAAAA,EAAE,EAACA,EAD+B;AAElCC,IAAAA,KAAK,EAACA,KAF4B;AAGlCO,IAAAA,SAAS,EAACN,WAHwB;AAIlCC,IAAAA,UAAU,EAACA,UAJuB;AAKlCM,IAAAA,OAAO,EAAC,IAL0B;AAMlCL,IAAAA,KAAK,EAACA,KAN4B;AAOlCC,IAAAA,OAAO,EAACA;AAP0B,GAAF,CAApC;AAUA,QAAM,CAACK,MAAD,EAASC,SAAT,IAAsB5B,QAAQ,CAAC,EAAD,CAApC;AAEA,QAAM6B,GAAG,GAAE,uBAAX;AAEA,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgC/B,QAAQ,CAAC,EAAD,CAA9C,CAlBkB,CAoBlB;;AACA,QAAMgC,UAAU,GAAGC,IAAI,IAAI;AACvB,UAAMC,QAAQ,GAAGD,IAAI,CAACE,WAAL,KAAoB,GAApB,IAA2BF,IAAI,CAACG,QAAL,KAAgB,CAA3C,IAA+C,GAA/C,GAAqDH,IAAI,CAACI,OAAL,EAAtE;AACAb,IAAAA,SAAS,CAAE,EACP,GAAGD,MADI;AAEPE,MAAAA,SAAS,EAACS;AAFH,KAAF,CAAT;AAIH,GAND,CArBkB,CA6BlB;;;AACA,QAAMI,WAAW,GAAGL,IAAI,IAAI;AACxB,UAAMM,SAAS,GAAGN,IAAI,CAACE,WAAL,KAAoB,GAApB,IAA2BF,IAAI,CAACG,QAAL,KAAgB,CAA3C,IAA+C,GAA/C,GAAqDH,IAAI,CAACI,OAAL,EAAvE;AACAb,IAAAA,SAAS,CAAE,EACP,GAAGD,MADI;AAEPG,MAAAA,OAAO,EAACa;AAFD,KAAF,CAAT;AAIH,GAND,CA9BkB,CAsClB;;;AACA,QAAMC,cAAc,GAAG,YAAW;AAC9B,QAAI;AACA,YAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAEb,GAAG,GAAG,wBAAR,CAA5B;AACA,YAAMc,IAAI,GAAG,MAAMF,QAAQ,CAACE,IAAT,EAAnB;AACAZ,MAAAA,cAAc,CAACY,IAAD,CAAd;AACH,KAJD,CAIC,OAAOC,KAAP,EAAc;AACXb,MAAAA,cAAc,CAAC,EAAD,CAAd;AACAc,MAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACH;;AAAA;AACJ,GATD;;AAWA7C,EAAAA,SAAS,CAAC,MAAK;AACXuC,IAAAA,cAAc;AACjB,GAFQ,EAEN,EAFM,CAAT;;AAIA,QAAMO,KAAK,GAAIC,CAAD,IAAO;AACjBxB,IAAAA,SAAS,CAAE,EACP,GAAGD,MADI;AAEP,OAACyB,CAAC,CAACC,MAAF,CAASC,IAAV,GAAiBF,CAAC,CAACC,MAAF,CAASE;AAFnB,KAAF,CAAT;AAIH,GALD,CAtDkB,CA6DlB;;;AACA,QAAMC,WAAW,GAAIJ,CAAD,IAAO;AAEvB,UAAMK,QAAQ,GAAG;AACb,YAAK9B,MAAM,CAACN,EADC;AAEb,eAAQM,MAAM,CAACL,KAFF;AAGb,mBAAYK,MAAM,CAACE,SAHN;AAIb,iBAAUF,MAAM,CAACG,OAJJ;AAKb,eAAQH,MAAM,CAACF,KALF;AAMb,oBAAaE,MAAM,CAACH,UANP;AAOb,iBAAUG,MAAM,CAACD;AAPJ,KAAjB;AAUAT,IAAAA,KAAK,CAACyC,IAAN,CAAYzB,GAAG,GAAG,wBAAN,GAAiCN,MAAM,CAACN,EAApD,EAAwDoC,QAAxD,EACCE,IADD,CACMd,QAAQ,IAAI;AACdI,MAAAA,OAAO,CAACC,GAAR,CAAYvB,MAAZ;;AACA,UAAIkB,QAAQ,CAACe,MAAT,KAAoB,GAAxB,EAA4B;AACxBhC,QAAAA,SAAS,CAAC,EACN,GAAGD,MADG;AAENN,UAAAA,EAAE,EAAC,EAFG;AAGNC,UAAAA,KAAK,EAAC,EAHA;AAINO,UAAAA,SAAS,EAAC,IAAIgC,IAAJ,EAJJ;AAKNrC,UAAAA,UAAU,EAAC,EALL;AAMNM,UAAAA,OAAO,EAAC,IANF;AAONL,UAAAA,KAAK,EAAC,EAPA;AAQNC,UAAAA,OAAO,EAAC;AARF,SAAD,CAAT;AAUAM,QAAAA,SAAS,CAAC,qCAAD,CAAT;AACH,OAZD,MAYK;AACDA,QAAAA,SAAS,CAAC,wBAAD,CAAT;AACH;AACJ,KAlBD;AAmBH,GA/BD;;AAiCA,sBACI;AAAA,2BACI,QAAC,KAAD;AAAO,MAAA,SAAS,EAAE,CAAlB;AAAqB,MAAA,KAAK,EAAE;AAAC8B,QAAAA,KAAK,EAAC,KAAP;AAAcC,QAAAA,MAAM,EAAC;AAArB,OAA5B;AAAA,8BACI;AAAM,QAAA,KAAK,EAAE;AAACC,UAAAA,OAAO,EAAC;AAAT,SAAb;AAAA,gCAEI,QAAC,SAAD;AACI,UAAA,QAAQ,MADZ;AAEI,UAAA,SAAS,MAFb;AAGI,UAAA,IAAI,EAAC,OAHT;AAII,UAAA,KAAK,EAAC,OAJV;AAKI,UAAA,KAAK,EAAErC,MAAM,CAACL,KALlB;AAMI,UAAA,QAAQ,EAAK8B,CAAD,IAAOD,KAAK,CAACC,CAAD;AAN5B;AAAA;AAAA;AAAA;AAAA,gBAFJ,eAUI,QAAC,uBAAD;AAAyB,UAAA,KAAK,EAAErC,YAAhC;AAA8C,UAAA,MAAM,EAAEC,QAAtD;AAAA,iCACI,QAAC,kBAAD;AAAoB,YAAA,KAAK,EAAC,mBAA1B;AAAwC,YAAA,IAAI,EAAC,WAA7C;AACI,YAAA,SAAS,EAAE,IADf;AAEI,YAAA,WAAW,EAAC,SAFhB;AAGI,YAAA,QAAQ,MAHZ;AAII,YAAA,KAAK,EAAEW,MAAM,CAACE,SAJlB;AAKI,YAAA,QAAQ,EAAEO,UALd;AAMI,YAAA,MAAM,EAAC;AANX;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAVJ,eAqBI,QAAC,UAAD;AAAY,UAAA,EAAE,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBArBJ,eAsBQ,QAAC,MAAD;AACI,UAAA,KAAK,EAAC,kBADV;AAEI,UAAA,QAAQ,MAFZ;AAGI,UAAA,SAAS,MAHb;AAII,UAAA,IAAI,EAAC,YAJT;AAKI,UAAA,KAAK,EAAET,MAAM,CAACH,UALlB;AAMI,UAAA,QAAQ,EAAI4B,CAAD,IAAOD,KAAK,CAACC,CAAD,CAN3B;AAOI,UAAA,OAAO,EAAC,OAPZ;AAAA,oBAUKlB,WAAW,CAAC+B,GAAZ,CAAgBzC,UAAU,IAAI;AAC3B,gCACI,QAAC,QAAD;AAAyC,cAAA,KAAK,EAAEA,UAAU,CAAC0C,OAAX,GAAqB,GAArB,GAA2B1C,UAAU,CAAC2C,QAAtF;AAAA,yBAAkG3C,UAAU,CAAC0C,OAA7G,OAAuH1C,UAAU,CAAC2C,QAAlI;AAAA,eAAe3C,UAAU,CAAC4C,aAA1B;AAAA;AAAA;AAAA;AAAA,oBADJ;AAGH,WAJA;AAVL;AAAA;AAAA;AAAA;AAAA,gBAtBR,eAuCI,QAAC,uBAAD;AAAyB,UAAA,KAAK,EAAErD,YAAhC;AAA8C,UAAA,MAAM,EAAEC,QAAtD;AAAA,iCACI,QAAC,kBAAD;AAAoB,YAAA,KAAK,EAAC,qBAA1B;AAA0C,YAAA,IAAI,EAAC,SAA/C;AACI,YAAA,SAAS,EAAE,IADf;AAEI,YAAA,WAAW,EAAC,SAFhB;AAGI,YAAA,KAAK,EAAEW,MAAM,CAACG,OAHlB;AAII,YAAA,QAAQ,EAAGY,WAJf;AAKI,YAAA,MAAM,EAAC;AALX;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAvCJ,eAgDI,QAAC,SAAD;AACI,UAAA,QAAQ,MADZ;AAEI,UAAA,SAAS,MAFb;AAGI,UAAA,IAAI,EAAC,OAHT;AAII,UAAA,KAAK,EAAC,OAJV;AAKI,UAAA,KAAK,EAAEf,MAAM,CAACF,KALlB;AAMI,UAAA,QAAQ,EAAK2B,CAAD,IAAOD,KAAK,CAACC,CAAD;AAN5B;AAAA;AAAA;AAAA;AAAA,gBAhDJ,eAwDI,QAAC,SAAD;AACI,UAAA,QAAQ,MADZ;AAEI,UAAA,SAAS,MAFb;AAGI,UAAA,IAAI,EAAC,SAHT;AAII,UAAA,KAAK,EAAC,SAJV;AAKI,UAAA,KAAK,EAAEzB,MAAM,CAACD,OALlB;AAMI,UAAA,QAAQ,EAAK0B,CAAD,IAAOD,KAAK,CAACC,CAAD;AAN5B;AAAA;AAAA;AAAA;AAAA,gBAxDJ;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eAkEI,QAAC,MAAD;AACI,QAAA,KAAK,EAAE;AAACW,UAAAA,MAAM,EAAC;AAAR,SADX;AAEI,QAAA,OAAO,EAAC,WAFZ;AAGI,QAAA,KAAK,EAAC,SAHV;AAII,QAAA,SAAS,eAAE,QAAC,WAAD;AAAA;AAAA;AAAA;AAAA,gBAJf;AAKI,QAAA,OAAO,EAAEP,WALb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAlEJ,eA2EI,QAAC,UAAD;AAAA,kBAAazB;AAAb;AAAA;AAAA;AAAA;AAAA,cA3EJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,UADJ;AAiFH;;GAhLQX,U;UAEsDD,S;;;KAFtDC,U;AAgLR;AAED,eAAeA,UAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport DoneAllIcon from '@material-ui/icons/DoneAll';\r\n\r\nimport {MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport fiLocale from 'date-fns/locale/fi';\r\n\r\nimport axios from 'axios';\r\nimport { Button } from '@material-ui/core';\r\nimport { useParams } from 'react-router';\r\n\r\nfunction TilausEdit() {\r\n    //haetaan parametrit urlista ja asetetaan ne tilamuuttujaan\r\n    let {id, tuote, tilauspaiva, tyontekija, hinta, asiakas} = useParams();\r\n\r\n    const [tilaus, setValues] = useState ({\r\n        id:id,\r\n        tuote:tuote,\r\n        tilauspvm:tilauspaiva,\r\n        tyontekija:tyontekija,\r\n        toimpvm:null,\r\n        hinta:hinta,\r\n        asiakas:asiakas\r\n    });\r\n\r\n    const [viesti, setViesti] = useState('');\r\n\r\n    const url= 'http://localhost:8080';\r\n\r\n    const [tyontekijat, setTyontekijat] = useState([]);\r\n\r\n    //tilauspäivän muutos\r\n    const muutaPaiva = date => {\r\n        const tilpaiva = date.getFullYear()+ '-' + (date.getMonth()+1)+ '-' + date.getDate();\r\n        setValues ({\r\n            ...tilaus,\r\n            tilauspvm:tilpaiva\r\n        });\r\n    };\r\n\r\n    //toimituspaivan muutos\r\n    const muutaTPaiva = date => {\r\n        const toimpaiva = date.getFullYear()+ '-' + (date.getMonth()+1)+ '-' + date.getDate()\r\n        setValues ({\r\n            ...tilaus,\r\n            toimpvm:toimpaiva\r\n        });\r\n    };\r\n\r\n    //haetaan työntekijät kannasta formia varten\r\n    const haeTyontekijat = async() => {\r\n        try {\r\n            const response = await fetch (url + '/kanta/tyontekijat/all');\r\n            const json = await response.json();\r\n            setTyontekijat(json);\r\n        }catch (error) {\r\n            setTyontekijat([]);\r\n            console.log('Haku ei onnistunut');\r\n        };\r\n    };\r\n\r\n    useEffect(() =>{\r\n        haeTyontekijat();\r\n    }, []);\r\n\r\n    const muuta = (e) => {\r\n        setValues ({\r\n            ...tilaus,\r\n            [e.target.name]: e.target.value\r\n        });\r\n    };\r\n\r\n    //muokatun tilauksen lisääminen kantaan\r\n    const lisaaTilaus = (e) => {\r\n\r\n        const formData = {\r\n            'id':tilaus.id,\r\n            'tuote':tilaus.tuote,\r\n            'tilauspvm':tilaus.tilauspvm,\r\n            'toimpvm':tilaus.toimpvm,\r\n            'hinta':tilaus.hinta,\r\n            'tyontekija':tilaus.tyontekija,\r\n            'asiakas':tilaus.asiakas,\r\n        }\r\n\r\n        axios.post( url + '/kanta/tilaukset/edit/' + tilaus.id, formData)\r\n        .then(response => {\r\n            console.log(tilaus)\r\n            if (response.status === 200){\r\n                setValues({\r\n                    ...tilaus,\r\n                    id:'',\r\n                    tuote:'',\r\n                    tilauspvm:new Date(),\r\n                    tyontekija:'',\r\n                    toimpvm:null,\r\n                    hinta:'',\r\n                    asiakas:''\r\n                })\r\n                setViesti('Muokkaus onnistui, palaa tilauksiin')\r\n            }else{\r\n                setViesti('Muokkaus ei onnistunut')\r\n            }\r\n        })\r\n    };\r\n    \r\n    return(\r\n        <div>\r\n            <Paper elevation={3} style={{width:'50%', margin:10}}>\r\n                <form style={{padding:20}}>\r\n\r\n                    <TextField \r\n                        required\r\n                        fullWidth \r\n                        name='tuote'\r\n                        label='Tuote' \r\n                        value={tilaus.tuote}\r\n                        onChange = {(e) => muuta(e)}/>\r\n\r\n                    <MuiPickersUtilsProvider utils={DateFnsUtils} locale={fiLocale} >\r\n                        <KeyboardDatePicker label='Tilauspäivä' name='tilauspvm'\r\n                            fullWidth={true} \r\n                            cancelLabel='Peruuta'\r\n                            required\r\n                            value={tilaus.tilauspvm}\r\n                            onChange={muutaPaiva}\r\n                            format='dd.MM.yyyy' />\r\n                    </MuiPickersUtilsProvider>\r\n\r\n                    \r\n                    <InputLabel id=\"tyont\">Työntekijä</InputLabel>\r\n                        <Select\r\n                            label='Työntekijä'\r\n                            required\r\n                            fullWidth\r\n                            name='tyontekija'\r\n                            value={tilaus.tyontekija}\r\n                            onChange= {(e) => muuta(e)}\r\n                            labelId='tyont'\r\n                            >\r\n                            {/*Mapataan kannasta haetut työntekijät selectin vaihtoehdoiksi */}\r\n                            {tyontekijat.map(tyontekija => {\r\n                                return(\r\n                                    <MenuItem key={tyontekija.tyontekija_id} value={tyontekija.etunimi + \" \" + tyontekija.sukunimi }>{tyontekija.etunimi} {tyontekija.sukunimi}</MenuItem>\r\n                                )\r\n                            })}\r\n                        </Select>\r\n                \r\n                    <MuiPickersUtilsProvider utils={DateFnsUtils} locale={fiLocale}>\r\n                        <KeyboardDatePicker label='Toimituspäivä' name='toimpva'\r\n                            fullWidth={true} \r\n                            cancelLabel='Peruuta'                   \r\n                            value={tilaus.toimpvm}\r\n                            onChange={ muutaTPaiva}\r\n                            format='dd.MM.yyyy' />\r\n                    </MuiPickersUtilsProvider>\r\n\r\n                    <TextField \r\n                        required\r\n                        fullWidth\r\n                        name='hinta' \r\n                        label='Hinta' \r\n                        value={tilaus.hinta}\r\n                        onChange = {(e) => muuta(e)}/>\r\n\r\n                    <TextField \r\n                        required\r\n                        fullWidth \r\n                        name='asiakas'\r\n                        label='Asiakas' \r\n                        value={tilaus.asiakas}\r\n                        onChange = {(e) => muuta(e)}/>\r\n\r\n                </form>\r\n                <Button\r\n                    style={{margin:10}}\r\n                    variant='contained'\r\n                    color='primary'\r\n                    startIcon={<DoneAllIcon/>}\r\n                    onClick={lisaaTilaus}>\r\n                        Tallenna muutokset\r\n                </Button>\r\n\r\n                <Typography>{viesti}</Typography>\r\n            </Paper>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TilausEdit;"]},"metadata":{},"sourceType":"module"}